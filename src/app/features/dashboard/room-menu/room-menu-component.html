<!-- src/app/features/dashboard/room-menu/room-menu-component.html -->

<app-header [userName]="userName"></app-header>

<div class="container">
  <div class="center-container">
    <!-- Kreis-Menü: Phase 1–3 -->
    @if (!isFlying && !flightPhase) {
      <div
        class="circle-group"
        [class.animate]="animateWheel"
        [class.align]="isAligning"
        [ngStyle]="{
           '--target-delta': selectedTargetDelta,
            '--spin-to-dur': spinToDurations[selectedIndex]
          }"
      >
        <app-button
          class="center-btn"
          name="Menu"
          icon="settings"
          (click)="toggleWheel()"
          [active]="animateWheel"
          [style.left.%]="50"
          [style.top.%]="50"
          size="8vw"
        ></app-button>
        @for (e of entities; track e.name; let i = $index) {
          <app-button
            class="circle-btn"
            [name]="e.name"
            [active]="e.active"
            [svgIcon]="e.svgIcon"
            [color]="e.color ?? 'red'"
            (click)="handleEntityClick(i)"
            [style.left.%]="50"
            [style.top.%]="50"
            [ngStyle]="{ '--angle': angles[i] }"
            size="8vw"
          ></app-button>
        }
      </div>
    }

    <!-- Flug-Phase (Phase 3) -->
    @if (isFlying) {
      <div class="circle-group flight">
        @for (e of entities; track e.name; let i = $index) {
          <app-button
            class="circle-btn"
            [name]="e.name"
            [svgIcon]="e.svgIcon"
            [color]="e.color ?? 'red'"
            [style.left.%]="50"
            [style.top.%]="50"
            [ngStyle]="{ '--angle': angles[i] }"
            size="7vw"
          ></app-button>
        }
      </div>
    }

    <!-- Detail-View (Phase 4) -->
    @if (flightPhase && activeEntityComponent) {
      <div class="entity-detail-container">
        <ng-container [ngComponentOutlet]="activeEntityComponent"></ng-container>
      </div>
    }

    <!-- Function-Menu immer unten -->
    <app-function-menu
      [entity]="entities[selectedIndex]"
      [position]="{ x: 44, y: 44 }"
      (close)="backFromFlight()"
    ></app-function-menu>
  </div>
</div>

<!-- Zusätzlicher Link zum Dashboard -->
<a routerLink="/dashboard" class="dashboard-link">Zum Dashboard</a>


<div class="device creator-minimal">
  <div class="top-row">
    <div class="status">
      <div class="dot" [class.on]="pcOn" [class.off]="!pcOn"></div>
      <div class="name">Creator PC</div>
      <div class="state">{{ pcOn ? 'Online' : 'Offline' }}</div>
    </div>

    <div class="actions-right" *ngIf="!pcOn">
      <button class="btn primary" (click)="$event.stopPropagation(); wakePc()" [class.inactive]="!wolAvailable" [title]="wolAvailable ? 'Wake on LAN' : 'Aktion nicht verfügbar'">
        ⚡ WOL
      </button>
    </div>

  </div>

  <div class="content" *ngIf="pcOn; else offlineTpl">
    <div class="gauges gauges-row">
      <app-speedometer style="--sm-height:90%; --sm-width:auto; flex:1 1 0; height:100%; max-width: calc((100% - (2 * var(--g-gap))) / 3);" [title]="'CPU'" [value]="cpuPercent"></app-speedometer>
      <span class="g-spacer" style="flex:0 0 var(--g-gap);"></span>
      <div class="gauge-wrapper gpu-wrapper" style="flex:1 1 0; height:100%; max-width: calc((100% - (2 * var(--g-gap))) / 3); position:relative;">
        <app-speedometer class="main" style="--sm-height:90%; --sm-width:auto; height:100%; width:100%;" [title]="metric2Label" [value]="gpuPercent || ramPercent"></app-speedometer>
        <app-speedometer class="mini" [title]="'GPU °C'" [value]="gpuTempC" [min]="0" [max]="110"></app-speedometer>
      </div>
      <span class="g-spacer" style="flex:0 0 var(--g-gap);"></span>
      <app-speedometer style="--sm-height:90%; --sm-width:auto; flex:1 1 0; height:100%; max-width: calc((100% - (2 * var(--g-gap))) / 3);" [title]="'Takt'" [value]="freqPercent" [max]="5300"></app-speedometer>
    </div>

    <div class="screenshot">
      <div class="screenshot-card">
        <img [src]="screenshotUrl"
             (load)="onScreenshotLoad()"
             (error)="onScreenshotError()"
             alt="PC Screenshot"
             style="width:100%; height:100%; object-fit:contain; object-position:center center;"
        />
        <div class="meta">
          <span class="time">{{ getCurrentTimestamp() }}</span>
        </div>
      </div>
    </div>

    <div class="buttons">
      <app-button
        name="Monitor an"
        [svgIcon]="'/assets/icons/monitor.svg'"
        [backgroundColor]="monitorOnAvailable ? '#5aa3b5' : '#424242'"
        [activeColor]="monitorOnAvailable ? '#246878' : '#616161'"
        [hoverColor]="monitorOnAvailable ? '#246878' : '#616161'"
        [active]="false"
        [glowOn]="false"
        (click)="monitorOnAvailable ? monitorOn() : null"
        [attr.title]="monitorOnAvailable ? 'Monitor aufwecken' : 'Monitor aus'"
      ></app-button>

      <app-button
        name="Play/Pause"
        [svgIcon]="'/assets/icons/playpause.svg'"
        [backgroundColor]="monitorOnAvailable ? '#5aa3b5' : '#424242'"
        [activeColor]="monitorOnAvailable ? '#246878' : '#616161'"
        [hoverColor]="monitorOnAvailable ? '#246878' : '#616161'"
        [active]="false"
        [glowOn]="false"
        (click)="mediaAvailable ? playPause() : null"
        [attr.title]="mediaAvailable ? 'Media Play/Pause' : 'Aktion nicht verfügbar'"
      ></app-button>

      <app-button
        name="Sleep"
        [svgIcon]="'/assets/icons/sleep.svg'"
        [backgroundColor]="monitorOnAvailable ? '#5aa3b5' : '#424242'"
        [activeColor]="monitorOnAvailable ? '#246878' : '#616161'"
        [hoverColor]="monitorOnAvailable ? '#246878' : '#616161'"
        [active]="false"
        [glowOn]="false"
        (click)="sleepAvailable ? sleep() : null"
        [attr.title]="sleepAvailable ? 'Ruhezustand' : 'Aktion nicht verfügbar'"
      ></app-button>

      <app-button
        name="Restart"
        [svgIcon]="'/assets/icons/restart.svg'"
        [backgroundColor]="monitorOnAvailable ? '#5aa3b5' : '#424242'"
        [activeColor]="monitorOnAvailable ? '#246878' : '#616161'"
        [hoverColor]="monitorOnAvailable ? '#246878' : '#616161'"
        [active]="false"
        [glowOn]="false"
        (click)="restartAvailable ? restart() : null"
        [attr.title]="restartAvailable ? 'Neu starten' : 'Aktion nicht verfügbar'"
      ></app-button>

      <app-button
        name="Shutdown"
        [svgIcon]="'/assets/icons/shutdown.svg'"
        [backgroundColor]="monitorOnAvailable ? '#5aa3b5' : '#424242'"
        [activeColor]="monitorOnAvailable ? '#246878' : '#616161'"
        [hoverColor]="monitorOnAvailable ? '#246878' : '#616161'"
        [active]="false"
        [glowOn]="false"
        (click)="shutdownAvailable ? shutdown() : null"
        [attr.title]="shutdownAvailable ? 'Herunterfahren' : 'Aktion nicht verfügbar'"
      ></app-button>
    </div>
  </div>

  <ng-template #offlineTpl>
    <div class="offline-box">
      <div>PC ist offline.</div>
      <button class="btn primary" (click)="$event.stopPropagation(); wakePc()" [class.inactive]="!wolAvailable" [title]="wolAvailable ? 'Wake on LAN' : 'Aktion nicht verfügbar'">
        ⚡ Aufwecken
      </button>
    </div>
  </ng-template>
</div>
